#!/bin/bash
# Iteration 1 — File Reorganization Script
# Auto-generated by Claude Code for architectural cleanup

set -e  # Exit on error

cd "$(dirname "$0")/.."  # Go to project root

echo "=== ITERATION 1: File Reorganization ==="
echo ""

# API tests → tests/api/
echo "[1/9] Moving API test files..."
git mv test_api_generate.py tests/api/ 2>/dev/null || true
git mv test_api_licenses.py tests/api/ 2>/dev/null || true
git mv test_locations_api.py tests/api/ 2>/dev/null || true
git mv test_mbappe_api.py tests/api/ 2>/dev/null || true
git mv test_tournament_api.py tests/api/ 2>/dev/null || true

# Auth tests → tests/auth/
git mv test_api_v1_login.py tests/auth/ 2>/dev/null || true

# Phase tests → tests/api/phases/
git mv test_phase1_api.py tests/api/phases/ 2>/dev/null || true
git mv test_phase1_creation_only.py tests/api/phases/ 2>/dev/null || true
git mv test_phase2_api.py tests/api/phases/ 2>/dev/null || true

# Tournament tests → tests/tournament/
echo "[2/9] Moving tournament test files..."
git mv test_full_regeneration.py tests/tournament/ 2>/dev/null || true
git mv test_number_of_rounds.py tests/tournament/ 2>/dev/null || true
git mv test_patch_regeneration.py tests/tournament/ 2>/dev/null || true
git mv test_preset_orchestrator.py tests/tournament/ 2>/dev/null || true
git mv test_start_tournament.py tests/tournament/ 2>/dev/null || true

# Ranking tests → tests/ranking/
git mv test_head_to_head_ranking.py tests/ranking/ 2>/dev/null || true

# Results tests → tests/results/
git mv test_round_results.py tests/results/ 2>/dev/null || true

# Skill tests → tests/skills/
echo "[3/9] Moving skill progression test files..."
git mv test_skill_progression_v2.py tests/skills/ 2>/dev/null || true
git mv test_skill_weight.py tests/skills/ 2>/dev/null || true
git mv test_skill_dashboard.py tests/skills/ 2>/dev/null || true

# Validation tests → tests/validation/
git mv test_skill_validation.py tests/validation/ 2>/dev/null || true

# Reward tests → tests/rewards/
echo "[4/9] Moving reward test files..."
git mv test_production_reward_config.py tests/rewards/ 2>/dev/null || true
git mv test_reward_distribution.py tests/rewards/ 2>/dev/null || true
git mv test_reward_distribution_tournament_94.py tests/rewards/ 2>/dev/null || true

# Schema tests → tests/schemas/
git mv test_reward_config_schema.py tests/schemas/ 2>/dev/null || true

# Feature tests → tests/features/
git mv test_campus_filter.py tests/features/ 2>/dev/null || true

# Database tests → tests/database/
git mv test_db_constraints.py tests/database/ 2>/dev/null || true

# Session tests → tests/sessions/
git mv test_generate_sessions.py tests/sessions/ 2>/dev/null || true

# Architecture tests → tests/architecture/
git mv test_new_architecture.py tests/architecture/ 2>/dev/null || true

# Parser tests → tests/parsers/
git mv test_parser_flexible.py tests/parsers/ 2>/dev/null || true
git mv test_time_parser.py tests/parsers/ 2>/dev/null || true

# Formatter tests → tests/formatters/
git mv test_time_formatter.py tests/formatters/ 2>/dev/null || true

# E2E tests → tests_e2e/legacy/
echo "[5/9] Moving E2E test files..."
git mv test_p3_end_to_end.py tests_e2e/legacy/ 2>/dev/null || true
git mv test_continue_tournament_e2e.py tests_e2e/legacy/ 2>/dev/null || true
git mv test_e2e_simple.py tests_e2e/legacy/ 2>/dev/null || true
git mv test_tied_ranks_e2e.py tests_e2e/legacy/ 2>/dev/null || true
git mv test_tournament_reward_e2e.py tests_e2e/legacy/ 2>/dev/null || true
git mv test_reward_config_e2e.py tests_e2e/legacy/ 2>/dev/null || true
git mv test_skill_progression_e2e.py tests_e2e/legacy/ 2>/dev/null || true
git mv comprehensive_tournament_e2e.py tests_e2e/legacy/ 2>/dev/null || true
git mv create_complete_tournament_e2e.py tests_e2e/legacy/ 2>/dev/null || true
git mv full_tournament_lifecycle_e2e.py tests_e2e/legacy/ 2>/dev/null || true

# Admin tools → scripts/admin_tools/
echo "[6/9] Moving Streamlit admin tools..."
git mv streamlit_sandbox.py scripts/admin_tools/ 2>/dev/null || true
git mv streamlit_game_preset_admin.py scripts/admin_tools/ 2>/dev/null || true
git mv streamlit_preset_forms.py scripts/admin_tools/ 2>/dev/null || true
git mv streamlit_minimal_form_test.py scripts/admin_tools/ 2>/dev/null || true
git mv streamlit_skill_viewer.py scripts/admin_tools/ 2>/dev/null || true
git mv streamlit_tournament_list_test.py scripts/admin_tools/ 2>/dev/null || true
git mv streamlit_match_command_center_test.py scripts/admin_tools/ 2>/dev/null || true

# Migration scripts → scripts/migrations/
echo "[7/9] Moving migration scripts..."
git mv backfill_skill_progression.py scripts/migrations/ 2>/dev/null || true
git mv backfill_all_player_skills.py scripts/migrations/ 2>/dev/null || true
git mv migrate_onboarding_skills_to_football_skills.py scripts/migrations/ 2>/dev/null || true
git mv migrate_add_new_skills.py scripts/migrations/ 2>/dev/null || true
git mv recalculate_tournament_rankings.py scripts/migrations/ 2>/dev/null || true
git mv verify_onboarding_skills.py scripts/migrations/ 2>/dev/null || true
git mv fresh_database_reset.py scripts/migrations/ 2>/dev/null || true
git mv comprehensive_test_seed.py scripts/migrations/ 2>/dev/null || true

# Helper scripts → scripts/helpers/
echo "[8/9] Moving helper scripts..."
git mv sandbox_helpers.py scripts/helpers/ 2>/dev/null || true
git mv create_tournament_api_helper.py scripts/helpers/ 2>/dev/null || true
git mv create_tournament_via_sandbox.py scripts/helpers/ 2>/dev/null || true
git mv create_tournament_api.py scripts/helpers/ 2>/dev/null || true

# Debug scripts → scripts/debug/
echo "[9/9] Moving debug scripts..."
git mv debug_placement_551.py scripts/debug/ 2>/dev/null || true
git mv debug_placement_606.py scripts/debug/ 2>/dev/null || true
git mv debug_streamlit_selectors.py scripts/debug/ 2>/dev/null || true
git mv debug_query_param.py scripts/debug/ 2>/dev/null || true
git mv debug_query_param_530.py scripts/debug/ 2>/dev/null || true
git mv debug_query_param_532.py scripts/debug/ 2>/dev/null || true

# Maintenance scripts → scripts/maintenance/
echo "[Bonus] Moving maintenance scripts..."
git mv complete_tournament_230.py scripts/maintenance/ 2>/dev/null || true
git mv verify_production_fix.py scripts/maintenance/ 2>/dev/null || true
git mv validate_h2h_implementation.py scripts/maintenance/ 2>/dev/null || true
git mv verify_performance_card_fix.py scripts/maintenance/ 2>/dev/null || true
git mv validate_group_knockout_fix.py scripts/maintenance/ 2>/dev/null || true
git mv final_redistribution_sql.py scripts/maintenance/ 2>/dev/null || true
git mv final_redistribution.py scripts/maintenance/ 2>/dev/null || true
git mv add_nondestructive_markers.py scripts/maintenance/ 2>/dev/null || true
git mv create_bronze_match.py scripts/maintenance/ 2>/dev/null || true
git mv apply_kylian_skills.py scripts/maintenance/ 2>/dev/null || true
git mv record_bronze_result.py scripts/maintenance/ 2>/dev/null || true
git mv redistribute_tournaments_final.py scripts/maintenance/ 2>/dev/null || true
git mv fix_cole_palmer.py scripts/maintenance/ 2>/dev/null || true
git mv minimal_form_test.py scripts/maintenance/ 2>/dev/null || true

echo ""
echo "✓ File reorganization complete!"
echo ""
echo "Next steps:"
echo "  1. Review changes: git status"
echo "  2. Run smoke tests: pytest tests/unit/ -q"
echo "  3. Commit: git commit -m 'refactor: reorganize root-level files into structured directories (Iter 1A-1B)'"

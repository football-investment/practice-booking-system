/* Chrome iOS Optimizations for iPad Air 2020 & iPhone 12 Pro Max */
/* Specific fixes to ensure optimal Chrome experience and avoid Firefox issues */

/* Chrome iOS Detection and Baseline Optimizations */
@supports (-webkit-touch-callout: none) {
  /* iOS Chrome specific viewport handling */
  html {
    height: 100%;
    height: -webkit-fill-available;
    /* Prevent zoom on orientation change */
    -webkit-text-size-adjust: 100%;
    text-size-adjust: 100%;
  }
  
  body {
    min-height: 100vh;
    min-height: -webkit-fill-available;
    /* Chrome iOS touch optimization */
    touch-action: manipulation;
  }
}

/* Chrome iOS Form Element Optimizations */
input, textarea, select {
  /* Critical: Prevent zoom on focus in Chrome iOS */
  font-size: 16px !important;
  
  /* Chrome-specific appearance reset */
  -webkit-appearance: none;
  appearance: none;
  
  /* Optimal touch targets for Chrome iOS */
  min-height: 44px;
  padding: 12px 16px;
  box-sizing: border-box;
  
  /* Chrome iOS focus handling */
  outline: none;
  border: 2px solid var(--border-light, #E5E7EB);
  border-radius: 8px;
  background-color: var(--bg-input, white);
  
  /* Smooth transitions for Chrome iOS */
  transition: border-color 0.2s ease, box-shadow 0.2s ease;
  
  /* Prevent unwanted highlighting */
  -webkit-tap-highlight-color: transparent;
  
  /* Chrome iOS text selection */
  -webkit-user-select: text;
  user-select: text;
}

input:focus, textarea:focus, select:focus {
  border-color: var(--color-primary, #007AFF);
  box-shadow: 0 0 0 3px rgba(0, 122, 255, 0.1);
  /* Prevent zoom on focus */
  transform: translateZ(0);
}

/* Chrome iOS Button Optimizations */
button {
  /* Essential Chrome iOS touch optimizations */
  -webkit-tap-highlight-color: rgba(0, 122, 255, 0.1);
  touch-action: manipulation;
  user-select: none;
  -webkit-user-select: none;
  
  /* Chrome iOS appearance */
  -webkit-appearance: none;
  appearance: none;
  border: none;
  border-radius: 8px;
  
  /* Optimal sizing for Chrome iOS */
  min-height: 44px;
  padding: 12px 24px;
  font-size: 16px;
  font-weight: 600;
  box-sizing: border-box;
  
  /* Chrome iOS interaction feedback */
  transition: all 0.2s ease;
  cursor: pointer;
  
  /* Prevent text selection on buttons */
  -webkit-user-select: none;
  user-select: none;
}

button:active {
  transform: scale(0.98);
  /* Hardware acceleration */
  -webkit-transform: scale(0.98) translateZ(0);
}

/* Chrome iOS Checkbox & Label Optimizations */
.checkbox-label, label {
  /* Optimal touch target for Chrome iOS */
  min-height: 44px;
  display: flex;
  align-items: center;
  gap: 12px;
  
  /* Chrome iOS interaction */
  -webkit-tap-highlight-color: rgba(0, 122, 255, 0.05);
  touch-action: manipulation;
  user-select: none;
  -webkit-user-select: none;
  cursor: pointer;
  
  /* Chrome iOS styling */
  padding: 12px 16px;
  border-radius: 8px;
  border: 2px solid transparent;
  transition: all 0.2s ease;
  box-sizing: border-box;
}

.checkbox-label:hover, label:hover {
  background-color: rgba(0, 122, 255, 0.05);
  border-color: rgba(0, 122, 255, 0.2);
}

input[type="checkbox"], input[type="radio"] {
  /* Chrome iOS checkbox/radio styling */
  width: 20px;
  height: 20px;
  min-width: 20px;
  min-height: 20px;
  accent-color: var(--color-primary, #007AFF);
  
  /* Chrome iOS interaction */
  cursor: pointer;
  touch-action: manipulation;
  
  /* Better positioning */
  flex-shrink: 0;
  margin: 0;
}

/* Chrome iOS Safe Area Handling */
.chrome-ios-safe-area {
  padding-top: env(safe-area-inset-top);
  padding-bottom: env(safe-area-inset-bottom);
  padding-left: env(safe-area-inset-left);
  padding-right: env(safe-area-inset-right);
}

/* Chrome iOS Scroll Optimizations */
.chrome-ios-scroll {
  -webkit-overflow-scrolling: touch;
  scroll-behavior: smooth;
  /* Hardware acceleration for smooth scrolling */
  -webkit-transform: translateZ(0);
  transform: translateZ(0);
}

/* Chrome iOS Animation & Performance */
.chrome-ios-animate {
  /* Hardware acceleration for Chrome iOS */
  -webkit-transform: translateZ(0);
  transform: translateZ(0);
  -webkit-backface-visibility: hidden;
  backface-visibility: hidden;
  /* Optimize rendering performance */
  will-change: transform, opacity;
}

/* Device-Specific Optimizations */

/* iPad Air 2020 in Chrome */
@media only screen 
  and (min-device-width: 820px) 
  and (max-device-width: 1180px)
  and (-webkit-min-device-pixel-ratio: 2) {
  
  .ipad-chrome-optimized {
    /* Better readability on iPad in Chrome */
    font-size: 18px;
    line-height: 1.5;
  }
  
  .ipad-chrome-optimized .touch-target,
  .ipad-chrome-optimized button,
  .ipad-chrome-optimized .checkbox-label {
    /* Larger touch targets for iPad */
    min-height: 48px;
    min-width: 48px;
  }
  
  .ipad-chrome-optimized input,
  .ipad-chrome-optimized textarea,
  .ipad-chrome-optimized select {
    /* Better spacing for iPad */
    padding: 16px 20px;
    font-size: 18px !important;
  }
}

/* iPhone 12 Pro Max in Chrome */
@media only screen 
  and (device-width: 428px) 
  and (device-height: 926px)
  and (-webkit-device-pixel-ratio: 3) {
  
  .iphone-chrome-optimized {
    /* Optimal font sizing for iPhone 12 Pro Max */
    font-size: 16px;
    line-height: 1.4;
  }
  
  .iphone-chrome-optimized .touch-target,
  .iphone-chrome-optimized button,
  .iphone-chrome-optimized .checkbox-label {
    /* Standard iOS touch targets */
    min-height: 44px;
    min-width: 44px;
  }
  
  .iphone-chrome-optimized input,
  .iphone-chrome-optimized textarea,
  .iphone-chrome-optimized select {
    /* Prevent zoom on iPhone */
    font-size: 16px !important;
    padding: 14px 18px;
  }
}

/* Chrome iOS Dark Mode Support */
@media (prefers-color-scheme: dark) {
  .chrome-ios-dark input,
  .chrome-ios-dark textarea,
  .chrome-ios-dark select {
    background-color: var(--bg-secondary, #2C2C2E);
    border-color: var(--border-dark, #48484A);
    color: var(--text-primary, #FFFFFF);
  }
  
  .chrome-ios-dark button {
    background-color: var(--color-primary, #007AFF);
    color: white;
  }
}

/* Chrome iOS Focus Management */
.chrome-ios-focus-trap {
  position: relative;
}

.chrome-ios-focus-trap:focus-within {
  outline: 3px solid var(--color-primary, #007AFF);
  outline-offset: 2px;
  border-radius: 8px;
}

/* Chrome iOS Modal/Overlay Optimizations */
.chrome-ios-modal {
  /* Prevent background scrolling */
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  height: -webkit-fill-available;
  
  /* Hardware acceleration */
  -webkit-transform: translateZ(0);
  transform: translateZ(0);
  
  /* Safe area handling */
  padding: env(safe-area-inset-top) env(safe-area-inset-right) env(safe-area-inset-bottom) env(safe-area-inset-left);
}

/* Chrome iOS Error Prevention */
.chrome-ios-stable {
  /* Prevent common Chrome iOS rendering issues */
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  text-rendering: optimizeLegibility;
  
  /* Stable positioning */
  -webkit-transform: translateZ(0);
  transform: translateZ(0);
}

/* Onboarding-specific Chrome iOS fixes */
.student-onboarding.chrome-ios-optimized {
  /* Apply all Chrome iOS optimizations to onboarding */
  -webkit-text-size-adjust: 100%;
  text-size-adjust: 100%;
}

.student-onboarding.chrome-ios-optimized .checkbox-label {
  /* Ensure NDA checkbox works perfectly in Chrome iOS */
  -webkit-tap-highlight-color: rgba(0, 122, 255, 0.1);
  touch-action: manipulation;
  user-select: none;
  -webkit-user-select: none;
}

.student-onboarding.chrome-ios-optimized .checkbox-label input[type="checkbox"] {
  /* Perfect checkbox behavior in Chrome iOS */
  touch-action: manipulation;
  cursor: pointer;
  -webkit-appearance: checkbox;
  appearance: checkbox;
}

/* Chrome iOS Network Request Optimizations */
.chrome-ios-network-stable {
  /* Styles that help with stable network requests */
  will-change: auto; /* Reset will-change to prevent memory issues */
}

/* Chrome iOS Memory Management */
.chrome-ios-memory-optimized {
  /* Prevent memory leaks in Chrome iOS */
  contain: layout style paint;
}

/* Chrome iOS Typography */
.chrome-ios-text {
  /* Optimal text rendering for Chrome iOS */
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  text-rendering: optimizeLegibility;
}